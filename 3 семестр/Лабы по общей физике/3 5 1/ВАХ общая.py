import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import CubicSpline

# Погрешности
delta_U = 0.005  # В
delta_I = 0.01   # мкА

# Данные 1
U1 = [24.729, 21.779, 18.643, 15.934, 12.684, 9.742, 7.643, 5.752, 3.7703, 1.7381, 
      0.137, -0.845, -2.411, -4.398, -6.32, -8.283, -10.831, -13.312, -16.283, -19.586, -22.467, -25.494]
I1 = [24.03, 23.11, 22.09, 21.19, 20.05, 18.93, 17.95, 16.68, 14.15, 8.22, 
      0.64, -4.42, -11.51, -16.91, -19.29, -20.57, -21.73, -22.77, -23.91, -25.06, -25.93, -26.83]

# Данные 2
U2 = [24.663, 21.686, 18.705, 15.702, 12.72, 9.706, 7.786, 5.665, 3.752, 1.728, 
      0.222, -0.865, -2.39, -4.439, -6.617, -8.431, -10.635, -13.661, -16.248, -19.462, -22.264, -25.508]
I2 = [15.2, 14.74, 14.11, 13.45, 12.745, 11.95, 11.31, 10.26, 8.29, 4.49, 
      0.51, -2.59, -6.54, -10.21, -12.18, -13.04, -13.78, -14.59, -15.27, -16.02, -16.61, -17.15]

# Данные 3
U3 = [24.809, 21.869, 18.747, 15.725, 12.884, 9.767, 7.603, 5.725, 3.675, 1.722, 
      0.158, -0.849, -2.389, -4.389, -6.482, -8.365, -10.243, -13.371, -16.364, -19.441, -22.437, -25.143]
I3 = [9.42, 9.08, 8.67, 8.23, 7.78, 7.27, 6.77, 6.08, 4.69, 2.46, 
      0.12, -1.47, -3.73, -5.89, -7.21, -7.84, -8.28, -8.86, -9.36, -9.84, -10.24, -10.62]

# Создаем график
plt.figure(figsize=(12, 8))

# Функция для построения одной ВАХ
def plot_VAX(U, I, color, label):
    # Сортируем данные по напряжению
    sorted_data = sorted(zip(U, I))
    U_sorted, I_sorted = zip(*sorted_data)
    
    # Строим кубический сплайн
    cs = CubicSpline(U_sorted, I_sorted)
    
    # Генерируем точки для плавной кривой
    U_smooth = np.linspace(min(U_sorted), max(U_sorted), 500)
    I_smooth = cs(U_smooth)
    
    # Строим кривую и точки с погрешностями
    plt.plot(U_smooth, I_smooth, color=color, linewidth=2, label=label)
    plt.errorbar(U, I, xerr=delta_U, yerr=delta_I, fmt='o', color=color, 
                 markersize=4, capsize=3, capthick=1, alpha=0.7)

# Строим все три зависимости
plot_VAX(U1, I1, 'blue', r'$I_р = 5,167$ мА')
plot_VAX(U2, I2, 'red', r'$I_р = 3,048$ мА')
plot_VAX(U3, I3, 'green', r'$I_р = 1,672$ мА')

# Настройки графика
plt.xlabel('U, В', fontsize=12)
plt.ylabel('I, мкА', fontsize=12)
plt.title('Вольт-амперные характеристики двойного зонда', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, linestyle='--', alpha=0.7)

# Добавляем линии осей координат
plt.axvline(x=0, color='black', linestyle='-', alpha=0.3)
plt.axhline(y=0, color='black', linestyle='-', alpha=0.3)

plt.tight_layout()
plt.show()